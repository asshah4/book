<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12.1 R/Medicine2020 course “Tidymodels, Virtually” | Thoughts</title>
  <meta name="description" content="A workspace for thoughts." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="12.1 R/Medicine2020 course “Tidymodels, Virtually” | Thoughts" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A workspace for thoughts." />
  <meta name="github-repo" content="asshah4/thoughts" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12.1 R/Medicine2020 course “Tidymodels, Virtually” | Thoughts" />
  
  <meta name="twitter:description" content="A workspace for thoughts." />
  

<meta name="author" content="Anish Shah" />


<meta name="date" content="2020-08-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidymodels.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Thoughts</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> <code>R</code> and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="git-and-github.html"><a href="git-and-github.html"><i class="fa fa-check"></i><b>1.2</b> <code>git</code> and Github</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Technical Setup</a><ul>
<li class="chapter" data-level="2.1" data-path="vim.html"><a href="vim.html"><i class="fa fa-check"></i><b>2.1</b> Vim</a></li>
<li class="chapter" data-level="2.2" data-path="mutt.html"><a href="mutt.html"><i class="fa fa-check"></i><b>2.2</b> Mutt</a></li>
<li class="chapter" data-level="2.3" data-path="building-a-cv.html"><a href="building-a-cv.html"><i class="fa fa-check"></i><b>2.3</b> Building a CV</a></li>
</ul></li>
<li class="part"><span><b>I Autonomic Regulation</b></span></li>
<li class="chapter" data-level="3" data-path="circadian.html"><a href="circadian.html"><i class="fa fa-check"></i><b>3</b> Circadian Physiology</a><ul>
<li class="chapter" data-level="3.1" data-path="chronobiology.html"><a href="chronobiology.html"><i class="fa fa-check"></i><b>3.1</b> Chronobiology</a></li>
<li class="chapter" data-level="3.2" data-path="circadian-disruption.html"><a href="circadian-disruption.html"><i class="fa fa-check"></i><b>3.2</b> Circadian Disruption</a></li>
<li class="chapter" data-level="3.3" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>3.3</b> References</a></li>
</ul></li>
<li class="part"><span><b>II Computational</b></span></li>
<li class="chapter" data-level="4" data-path="cosinor.html"><a href="cosinor.html"><i class="fa fa-check"></i><b>4</b> Cosinor Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="single-component-cosinor.html"><a href="single-component-cosinor.html"><i class="fa fa-check"></i><b>4.2</b> Single component cosinor</a></li>
<li class="chapter" data-level="4.3" data-path="population-mean-cosinor.html"><a href="population-mean-cosinor.html"><i class="fa fa-check"></i><b>4.3</b> Population-mean cosinor</a><ul>
<li class="chapter" data-level="4.3.1" data-path="population-mean-cosinor.html"><a href="population-mean-cosinor.html#confidence-intervals-for-population-cosinor"><i class="fa fa-check"></i><b>4.3.1</b> Confidence Intervals for Population Cosinor</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multiple-component-cosinor.html"><a href="multiple-component-cosinor.html"><i class="fa fa-check"></i><b>4.4</b> Multiple-Component Cosinor</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="heart.html"><a href="heart.html"><i class="fa fa-check"></i><b>5</b> Heart</a><ul>
<li class="chapter" data-level="5.1" data-path="using-s4.html"><a href="using-s4.html"><i class="fa fa-check"></i><b>5.1</b> Using S4</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>6</b> Package Development</a><ul>
<li class="chapter" data-level="6.1" data-path="documenting-a-package.html"><a href="documenting-a-package.html"><i class="fa fa-check"></i><b>6.1</b> Documenting a Package</a><ul>
<li class="chapter" data-level="6.1.1" data-path="documenting-a-package.html"><a href="documenting-a-package.html#website"><i class="fa fa-check"></i><b>6.1.1</b> Website</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="building-a-modeling-package.html"><a href="building-a-modeling-package.html"><i class="fa fa-check"></i><b>6.2</b> Building a Modeling Package</a><ul>
<li class="chapter" data-level="6.2.1" data-path="building-a-modeling-package.html"><a href="building-a-modeling-package.html#blueprints"><i class="fa fa-check"></i><b>6.2.1</b> Blueprints</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="speed-of-for-loops.html"><a href="speed-of-for-loops.html"><i class="fa fa-check"></i><b>7.1</b> Speed of <em>for loops</em></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>8</b> Modeling</a><ul>
<li class="chapter" data-level="8.1" data-path="modeling-multiple-outcomes-and-predictors.html"><a href="modeling-multiple-outcomes-and-predictors.html"><i class="fa fa-check"></i><b>8.1</b> Modeling Multiple Outcomes and Predictors</a><ul>
<li class="chapter" data-level="8.1.1" data-path="modeling-multiple-outcomes-and-predictors.html"><a href="modeling-multiple-outcomes-and-predictors.html#creating-multiple-models"><i class="fa fa-check"></i><b>8.1.1</b> Creating Multiple Models</a></li>
<li class="chapter" data-level="8.1.2" data-path="modeling-multiple-outcomes-and-predictors.html"><a href="modeling-multiple-outcomes-and-predictors.html#visualize-regression-estimates"><i class="fa fa-check"></i><b>8.1.2</b> Visualize Regression Estimates</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Electrocardiography</b></span></li>
<li class="chapter" data-level="9" data-path="vcg.html"><a href="vcg.html"><i class="fa fa-check"></i><b>9</b> Vectorcardiography</a><ul>
<li class="chapter" data-level="9.1" data-path="vector-gradients.html"><a href="vector-gradients.html"><i class="fa fa-check"></i><b>9.1</b> Vector Gradients</a></li>
<li class="chapter" data-level="9.2" data-path="global-electrical-heterogeneity.html"><a href="global-electrical-heterogeneity.html"><i class="fa fa-check"></i><b>9.2</b> Global Electrical Heterogeneity</a></li>
</ul></li>
<li class="part"><span><b>IV Clinical</b></span></li>
<li class="chapter" data-level="10" data-path="cardiac-catheterization.html"><a href="cardiac-catheterization.html"><i class="fa fa-check"></i><b>10</b> Cardiac Catheterization</a><ul>
<li class="chapter" data-level="10.1" data-path="right-heart-catheterization.html"><a href="right-heart-catheterization.html"><i class="fa fa-check"></i><b>10.1</b> Right heart catheterization</a></li>
<li class="chapter" data-level="10.2" data-path="invasive-hemodynamics.html"><a href="invasive-hemodynamics.html"><i class="fa fa-check"></i><b>10.2</b> Invasive Hemodynamics</a><ul>
<li class="chapter" data-level="10.2.1" data-path="invasive-hemodynamics.html"><a href="invasive-hemodynamics.html#ficks-cardiac-output"><i class="fa fa-check"></i><b>10.2.1</b> Fick’s cardiac output</a></li>
<li class="chapter" data-level="10.2.2" data-path="invasive-hemodynamics.html"><a href="invasive-hemodynamics.html#thermodilution"><i class="fa fa-check"></i><b>10.2.2</b> Thermodilution</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="coronary-anatomy.html"><a href="coronary-anatomy.html"><i class="fa fa-check"></i><b>10.3</b> Coronary Anatomy</a><ul>
<li class="chapter" data-level="10.3.1" data-path="coronary-anatomy.html"><a href="coronary-anatomy.html#text-processing"><i class="fa fa-check"></i><b>10.3.1</b> Text-processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="echo.html"><a href="echo.html"><i class="fa fa-check"></i><b>11</b> Echocardiography</a><ul>
<li class="chapter" data-level="11.1" data-path="chamber-size.html"><a href="chamber-size.html"><i class="fa fa-check"></i><b>11.1</b> Chamber size</a></li>
<li class="chapter" data-level="11.2" data-path="pressure-gradients.html"><a href="pressure-gradients.html"><i class="fa fa-check"></i><b>11.2</b> Pressure gradients</a></li>
</ul></li>
<li class="part"><span><b>V Learning</b></span></li>
<li class="chapter" data-level="12" data-path="tidymodels.html"><a href="tidymodels.html"><i class="fa fa-check"></i><b>12</b> Tidymodels</a><ul>
<li class="chapter" data-level="12.1" data-path="rmedicine2020-course-tidymodels-virtually.html"><a href="rmedicine2020-course-tidymodels-virtually.html"><i class="fa fa-check"></i><b>12.1</b> R/Medicine2020 course “Tidymodels, Virtually”</a><ul>
<li class="chapter" data-level="12.1.1" data-path="rmedicine2020-course-tidymodels-virtually.html"><a href="rmedicine2020-course-tidymodels-virtually.html#introduction"><i class="fa fa-check"></i><b>12.1.1</b> Introduction</a></li>
<li class="chapter" data-level="12.1.2" data-path="rmedicine2020-course-tidymodels-virtually.html"><a href="rmedicine2020-course-tidymodels-virtually.html#build-a-model"><i class="fa fa-check"></i><b>12.1.2</b> Build a Model</a></li>
<li class="chapter" data-level="12.1.3" data-path="rmedicine2020-course-tidymodels-virtually.html"><a href="rmedicine2020-course-tidymodels-virtually.html#build-a-workflow"><i class="fa fa-check"></i><b>12.1.3</b> Build a Workflow</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Thoughts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rmedicine2020-course-tidymodels-virtually" class="section level2">
<h2><span class="header-section-number">12.1</span> R/Medicine2020 course “Tidymodels, Virtually”</h2>
<p>As I begin to use <code>tidymodels</code> as a work-flow, I’m completing the #RMedicine2020 course. Initial setup below.</p>
<div id="introduction" class="section level3">
<h3><span class="header-section-number">12.1.1</span> Introduction</h3>
<p>Mentions that statistics is focused on inference while machine learning is focused on prediction.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 4.0.2</code></pre>
<pre><code>## ── Attaching packages ────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.3     ✓ dplyr   1.0.1
## ✓ tidyr   1.1.1     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.0.2</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb9-1"></a><span class="kw">library</span>(tidymodels)</span></code></pre></div>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────── tidymodels 0.1.0 ──</code></pre>
<pre><code>## ✓ broom     0.7.0.9000     ✓ rsample   0.0.6     
## ✓ dials     0.0.6          ✓ tune      0.1.0     
## ✓ infer     0.5.1          ✓ workflows 0.1.1     
## ✓ parsnip   0.1.1          ✓ yardstick 0.0.6     
## ✓ recipes   0.1.12</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────── tidymodels_conflicts() ──
## x scales::discard() masks purrr::discard()
## x dplyr::filter()   masks stats::filter()
## x recipes::fixed()  masks stringr::fixed()
## x dplyr::lag()      masks stats::lag()
## x dials::margin()   masks ggplot2::margin()
## x yardstick::spec() masks readr::spec()
## x recipes::step()   masks stats::step()</code></pre>
</div>
<div id="build-a-model" class="section level3">
<h3><span class="header-section-number">12.1.2</span> Build a Model</h3>
<p>Alzheimer’s disease data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb13-1"></a><span class="kw">library</span>(modeldata)</span></code></pre></div>
<pre><code>## Warning: package &#39;modeldata&#39; was built under R version 4.0.2</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb15-1"></a><span class="kw">data</span>(<span class="st">&quot;ad_data&quot;</span>)</span>
<span id="cb15-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb15-2"></a>alz &lt;-<span class="st"> </span>ad_data</span>
<span id="cb15-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb15-3"></a><span class="kw">glimpse</span>(alz)</span></code></pre></div>
<pre><code>## Rows: 333
## Columns: 131
## $ ACE_CD143_Angiotensin_Converti   &lt;dbl&gt; 2.0031003, 1.5618560, 1.5206598, 1.6…
## $ ACTH_Adrenocorticotropic_Hormon  &lt;dbl&gt; -1.3862944, -1.3862944, -1.7147984, …
## $ AXL                              &lt;dbl&gt; 1.09838668, 0.68328157, -0.14527630,…
## $ Adiponectin                      &lt;dbl&gt; -5.360193, -5.020686, -5.809143, -5.…
## $ Alpha_1_Antichymotrypsin         &lt;dbl&gt; 1.7404662, 1.4586150, 1.1939225, 1.2…
## $ Alpha_1_Antitrypsin              &lt;dbl&gt; -12.631361, -11.909882, -13.642963, …
## $ Alpha_1_Microglobulin            &lt;dbl&gt; -2.577022, -3.244194, -2.882404, -3.…
## $ Alpha_2_Macroglobulin            &lt;dbl&gt; -72.65029, -154.61228, -136.52918, -…
## $ Angiopoietin_2_ANG_2             &lt;dbl&gt; 1.06471074, 0.74193734, 0.83290912, …
## $ Angiotensinogen                  &lt;dbl&gt; 2.510547, 2.457283, 1.976365, 2.3760…
## $ Apolipoprotein_A_IV              &lt;dbl&gt; -1.427116, -1.660731, -1.660731, -2.…
## $ Apolipoprotein_A1                &lt;dbl&gt; -7.402052, -7.047017, -7.684284, -8.…
## $ Apolipoprotein_A2                &lt;dbl&gt; -0.26136476, -0.86750057, -0.6539264…
## $ Apolipoprotein_B                 &lt;dbl&gt; -4.624044, -6.747507, -3.976069, -6.…
## $ Apolipoprotein_CI                &lt;dbl&gt; -1.2729657, -1.2729657, -1.7147984, …
## $ Apolipoprotein_CIII              &lt;dbl&gt; -2.312635, -2.343407, -2.748872, -2.…
## $ Apolipoprotein_D                 &lt;dbl&gt; 2.0794415, 1.3350011, 1.3350011, 1.4…
## $ Apolipoprotein_E                 &lt;dbl&gt; 3.7545215, 3.0971187, 2.7530556, 2.3…
## $ Apolipoprotein_H                 &lt;dbl&gt; -0.15734908, -0.57539617, -0.3448393…
## $ B_Lymphocyte_Chemoattractant_BL  &lt;dbl&gt; 2.2969819, 1.6731213, 1.6731213, 1.9…
## $ BMP_6                            &lt;dbl&gt; -2.200744, -1.728053, -2.062421, -1.…
## $ Beta_2_Microglobulin             &lt;dbl&gt; 0.69314718, 0.47000363, 0.33647224, …
## $ Betacellulin                     &lt;int&gt; 34, 53, 49, 52, 67, 51, 41, 42, 58, …
## $ C_Reactive_Protein               &lt;dbl&gt; -4.074542, -6.645391, -8.047190, -6.…
## $ CD40                             &lt;dbl&gt; -0.7964147, -1.2733760, -1.2415199, …
## $ CD5L                             &lt;dbl&gt; 0.09531018, -0.67334455, 0.09531018,…
## $ Calbindin                        &lt;dbl&gt; 33.21363, 25.27636, 22.16609, 23.455…
## $ Calcitonin                       &lt;dbl&gt; 1.3862944, 3.6109179, 2.1162555, -0.…
## $ CgA                              &lt;dbl&gt; 397.6536, 465.6759, 347.8639, 334.23…
## $ Clusterin_Apo_J                  &lt;dbl&gt; 3.555348, 3.044522, 2.772589, 2.8332…
## $ Complement_3                     &lt;dbl&gt; -10.36305, -16.10824, -16.10824, -13…
## $ Complement_Factor_H              &lt;dbl&gt; 3.5737252, 3.6000471, 4.4745686, 3.0…
## $ Connective_Tissue_Growth_Factor  &lt;dbl&gt; 0.5306283, 0.5877867, 0.6418539, 0.5…
## $ Cortisol                         &lt;dbl&gt; 10.0, 12.0, 10.0, 14.0, 11.0, 13.0, …
## $ Creatine_Kinase_MB               &lt;dbl&gt; -1.710172, -1.751002, -1.383559, -1.…
## $ Cystatin_C                       &lt;dbl&gt; 9.041922, 9.067624, 8.954157, 9.5819…
## $ EGF_R                            &lt;dbl&gt; -0.1354543, -0.3700474, -0.7329871, …
## $ EN_RAGE                          &lt;dbl&gt; -3.688879, -3.816713, -4.755993, -2.…
## $ ENA_78                           &lt;dbl&gt; -1.349543, -1.356595, -1.390672, -1.…
## $ Eotaxin_3                        &lt;int&gt; 53, 62, 62, 44, 64, 57, 64, 64, 64, …
## $ FAS                              &lt;dbl&gt; -0.08338161, -0.52763274, -0.6348782…
## $ FSH_Follicle_Stimulation_Hormon  &lt;dbl&gt; -0.6516715, -1.6272839, -1.5630004, …
## $ Fas_Ligand                       &lt;dbl&gt; 3.1014922, 2.9788133, 1.3600098, 2.5…
## $ Fatty_Acid_Binding_Protein       &lt;dbl&gt; 2.5208712, 2.2477966, 0.9063009, 0.6…
## $ Ferritin                         &lt;dbl&gt; 3.329165, 3.932959, 3.176872, 3.1380…
## $ Fetuin_A                         &lt;dbl&gt; 1.2809338, 1.1939225, 1.4109870, 0.7…
## $ Fibrinogen                       &lt;dbl&gt; -7.035589, -8.047190, -7.195437, -7.…
## $ GRO_alpha                        &lt;dbl&gt; 1.381830, 1.372438, 1.412679, 1.3724…
## $ Gamma_Interferon_induced_Monokin &lt;dbl&gt; 2.949822, 2.721793, 2.762231, 2.8854…
## $ Glutathione_S_Transferase_alpha  &lt;dbl&gt; 1.0641271, 0.8670202, 0.8890150, 0.7…
## $ HB_EGF                           &lt;dbl&gt; 6.559746, 8.754531, 7.745463, 5.9494…
## $ HCC_4                            &lt;dbl&gt; -3.036554, -4.074542, -3.649659, -3.…
## $ Hepatocyte_Growth_Factor_HGF     &lt;dbl&gt; 0.58778666, 0.53062825, 0.09531018, …
## $ I_309                            &lt;dbl&gt; 3.433987, 3.135494, 2.397895, 3.3672…
## $ ICAM_1                           &lt;dbl&gt; -0.1907787, -0.4620172, -0.4620172, …
## $ IGF_BP_2                         &lt;dbl&gt; 5.609472, 5.347108, 5.181784, 5.4249…
## $ IL_11                            &lt;dbl&gt; 5.121987, 4.936704, 4.665910, 6.2239…
## $ IL_13                            &lt;dbl&gt; 1.282549, 1.269463, 1.274133, 1.3075…
## $ IL_16                            &lt;dbl&gt; 4.192081, 2.876338, 2.616102, 2.4410…
## $ IL_17E                           &lt;dbl&gt; 5.731246, 6.705891, 4.149327, 4.6958…
## $ IL_1alpha                        &lt;dbl&gt; -6.571283, -8.047190, -8.180721, -7.…
## $ IL_3                             &lt;dbl&gt; -3.244194, -3.912023, -4.645992, -4.…
## $ IL_4                             &lt;dbl&gt; 2.484907, 2.397895, 1.824549, 1.4816…
## $ IL_5                             &lt;dbl&gt; 1.09861229, 0.69314718, -0.24846136,…
## $ IL_6                             &lt;dbl&gt; 0.26936976, 0.09622438, 0.18568645, …
## $ IL_6_Receptor                    &lt;dbl&gt; 0.64279595, 0.43115645, 0.09668586, …
## $ IL_7                             &lt;dbl&gt; 4.8050453, 3.7055056, 1.0056222, 2.3…
## $ IL_8                             &lt;dbl&gt; 1.711325, 1.675557, 1.691393, 1.7199…
## $ IP_10_Inducible_Protein_10       &lt;dbl&gt; 6.242223, 5.686975, 5.049856, 5.6021…
## $ IgA                              &lt;dbl&gt; -6.812445, -6.377127, -6.319969, -7.…
## $ Insulin                          &lt;dbl&gt; -0.6258253, -0.9431406, -1.4466191, …
## $ Kidney_Injury_Molecule_1_KIM_1   &lt;dbl&gt; -1.204295, -1.197703, -1.191191, -1.…
## $ LOX_1                            &lt;dbl&gt; 1.7047481, 1.5260563, 1.1631508, 1.2…
## $ Leptin                           &lt;dbl&gt; -1.5290628, -1.4660558, -1.6622675, …
## $ Lipoprotein_a                    &lt;dbl&gt; -4.268698, -4.933674, -5.843045, -4.…
## $ MCP_1                            &lt;dbl&gt; 6.740519, 6.849066, 6.767343, 6.7810…
## $ MCP_2                            &lt;dbl&gt; 1.9805094, 1.8088944, 0.4005958, 1.9…
## $ MIF                              &lt;dbl&gt; -1.237874, -1.897120, -2.302585, -1.…
## $ MIP_1alpha                       &lt;dbl&gt; 4.968453, 3.690160, 4.049508, 4.9285…
## $ MIP_1beta                        &lt;dbl&gt; 3.258097, 3.135494, 2.397895, 3.2188…
## $ MMP_2                            &lt;dbl&gt; 4.478566, 3.781473, 2.866631, 2.9685…
## $ MMP_3                            &lt;dbl&gt; -2.207275, -2.465104, -2.302585, -1.…
## $ MMP10                            &lt;dbl&gt; -3.270169, -3.649659, -2.733368, -4.…
## $ MMP7                             &lt;dbl&gt; -3.7735027, -5.9681907, -4.0302269, …
## $ Myoglobin                        &lt;dbl&gt; -1.89711998, -0.75502258, -1.3862943…
## $ NT_proBNP                        &lt;dbl&gt; 4.553877, 4.219508, 4.248495, 4.1108…
## $ NrCAM                            &lt;dbl&gt; 5.003946, 5.209486, 4.744932, 4.9698…
## $ Osteopontin                      &lt;dbl&gt; 5.356586, 6.003887, 5.017280, 5.7683…
## $ PAI_1                            &lt;dbl&gt; 1.00350156, -0.03059880, 0.43837211,…
## $ PAPP_A                           &lt;dbl&gt; -2.902226, -2.813276, -2.935541, -2.…
## $ PLGF                             &lt;dbl&gt; 4.442651, 4.025352, 4.510860, 3.4339…
## $ PYY                              &lt;dbl&gt; 3.218876, 3.135494, 2.890372, 2.8332…
## $ Pancreatic_polypeptide           &lt;dbl&gt; 0.57878085, 0.33647224, -0.89159812,…
## $ Prolactin                        &lt;dbl&gt; 0.00000000, -0.51082562, -0.13926207…
## $ Prostatic_Acid_Phosphatase       &lt;dbl&gt; -1.620527, -1.739232, -1.636682, -1.…
## $ Protein_S                        &lt;dbl&gt; -1.784998, -2.463991, -2.259135, -2.…
## $ Pulmonary_and_Activation_Regulat &lt;dbl&gt; -0.8439701, -2.3025851, -1.6607312, …
## $ RANTES                           &lt;dbl&gt; -6.214608, -6.938214, -6.645391, -5.…
## $ Resistin                         &lt;dbl&gt; -16.475315, -16.025283, -16.475315, …
## $ S100b                            &lt;dbl&gt; 1.5618560, 1.7566212, 1.4357282, 1.2…
## $ SGOT                             &lt;dbl&gt; -0.94160854, -0.65392647, 0.33647224…
## $ SHBG                             &lt;dbl&gt; -1.897120, -1.560648, -2.207275, -3.…
## $ SOD                              &lt;dbl&gt; 5.609472, 5.814131, 5.723585, 5.7714…
## $ Serum_Amyloid_P                  &lt;dbl&gt; -5.599422, -6.119298, -5.381699, -6.…
## $ Sortilin                         &lt;dbl&gt; 4.908629, 5.478731, 3.810182, 3.4021…
## $ Stem_Cell_Factor                 &lt;dbl&gt; 4.174387, 3.713572, 3.433987, 3.9512…
## $ TGF_alpha                        &lt;dbl&gt; 8.649098, 11.331619, 10.858497, 9.45…
## $ TIMP_1                           &lt;dbl&gt; 15.204651, 11.266499, 12.282857, 11.…
## $ TNF_RII                          &lt;dbl&gt; -0.06187540, -0.32850407, -0.4155154…
## $ TRAIL_R3                         &lt;dbl&gt; -0.1829004, -0.5007471, -0.9240345, …
## $ TTR_prealbumin                   &lt;dbl&gt; 2.944439, 2.833213, 2.944439, 2.9444…
## $ Tamm_Horsfall_Protein_THP        &lt;dbl&gt; -3.095810, -3.111190, -3.166721, -3.…
## $ Thrombomodulin                   &lt;dbl&gt; -1.340566, -1.675252, -1.534276, -1.…
## $ Thrombopoietin                   &lt;dbl&gt; -0.1026334, -0.6733501, -0.9229670, …
## $ Thymus_Expressed_Chemokine_TECK  &lt;dbl&gt; 4.149327, 3.810182, 2.791992, 4.0372…
## $ Thyroid_Stimulating_Hormone      &lt;dbl&gt; -3.863233, -4.828314, -4.990833, -4.…
## $ Thyroxine_Binding_Globulin       &lt;dbl&gt; -1.4271164, -1.6094379, -1.8971200, …
## $ Tissue_Factor                    &lt;dbl&gt; 2.04122033, 2.02814825, 1.43508453, …
## $ Transferrin                      &lt;dbl&gt; 3.332205, 2.890372, 2.890372, 2.8903…
## $ Trefoil_Factor_3_TFF3            &lt;dbl&gt; -3.381395, -3.912023, -3.729701, -3.…
## $ VCAM_1                           &lt;dbl&gt; 3.258097, 2.708050, 2.639057, 2.7725…
## $ VEGF                             &lt;dbl&gt; 22.03456, 18.60184, 17.47619, 17.545…
## $ Vitronectin                      &lt;dbl&gt; -0.04082199, -0.38566248, -0.2231435…
## $ von_Willebrand_Factor            &lt;dbl&gt; -3.146555, -3.863233, -3.540459, -3.…
## $ age                              &lt;dbl&gt; 0.9876238, 0.9861496, 0.9866667, 0.9…
## $ tau                              &lt;dbl&gt; 6.297754, 6.659294, 6.270988, 6.1527…
## $ p_tau                            &lt;dbl&gt; 4.348108, 4.859967, 4.400247, 4.4948…
## $ Ab_42                            &lt;dbl&gt; 12.019678, 11.015759, 12.302271, 12.…
## $ male                             &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, …
## $ Genotype                         &lt;fct&gt; E3E3, E3E4, E3E4, E3E4, E3E3, E4E4, …
## $ Class                            &lt;fct&gt; Control, Control, Control, Control, …</code></pre>
<p>This data has 333, with 1 categorical outcome, and 130 predictors (126 protein measurements) and age, sex, and genetics.</p>
<p>Models can be built using <code>parsnip</code> package, which is different than base R (seen below)</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb17-1"></a><span class="kw">glm</span>(Class <span class="op">~</span><span class="st"> </span>tau, <span class="dt">family =</span> binomial, <span class="dt">data =</span> alz)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = Class ~ tau, family = binomial, data = alz)
## 
## Coefficients:
## (Intercept)          tau  
##      13.664       -2.148  
## 
## Degrees of Freedom: 332 Total (i.e. Null);  331 Residual
## Null Deviance:       390.6 
## Residual Deviance: 318.8     AIC: 322.8</code></pre>
<p>For <code>parsnip</code>, there are three general steps:</p>
<ol style="list-style-type: decimal">
<li>Pick a model</li>
<li>Set the engine</li>
<li>Set the mode (if needed)</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb19-1"></a><span class="co"># Using logistic reggresion as the model.</span></span>
<span id="cb19-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb19-2"></a><span class="kw">logistic_reg</span>(</span>
<span id="cb19-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb19-3"></a>    <span class="dt">mode =</span> <span class="st">&quot;classification&quot;</span>, <span class="co"># default if exists</span></span>
<span id="cb19-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb19-4"></a>    <span class="dt">penalty =</span> <span class="ot">NULL</span>, <span class="co"># hyperparameter</span></span>
<span id="cb19-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb19-5"></a>    <span class="dt">mixture =</span> <span class="ot">NULL</span> <span class="co"># hyperparameter</span></span>
<span id="cb19-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb19-6"></a>)</span></code></pre></div>
<pre><code>## Logistic Regression Model Specification (classification)</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb21-1"></a><span class="co"># Setting the engine to power/implement hte model</span></span>
<span id="cb21-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb21-2"></a><span class="kw">logistic_reg</span>() <span class="op">%&gt;%</span></span>
<span id="cb21-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb21-3"></a><span class="st">    </span><span class="kw">set_engine</span>(<span class="dt">engine =</span> <span class="st">&quot;glm&quot;</span>)</span></code></pre></div>
<pre><code>## Logistic Regression Model Specification (classification)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb23-1"></a><span class="co"># Can add a mod eif not set prior</span></span>
<span id="cb23-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb23-2"></a>lr_mod &lt;-<span class="st"> </span></span>
<span id="cb23-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb23-3"></a><span class="st">    </span><span class="kw">logistic_reg</span>() <span class="op">%&gt;%</span></span>
<span id="cb23-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb23-4"></a><span class="st">    </span><span class="kw">set_engine</span>(<span class="dt">engine =</span> <span class="st">&quot;glm&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb23-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb23-5"></a><span class="st">    </span><span class="kw">set_mode</span>(<span class="dt">mode =</span> <span class="st">&quot;classification&quot;</span>)</span></code></pre></div>
<p>As an example, make a decision tree model for classification, using C5.0 engine, and saved as <code>tree_mod</code> to evaluate.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-1"></a><span class="co"># Decision tree</span></span>
<span id="cb24-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-2"></a>tree_mod &lt;-<span class="st"> </span></span>
<span id="cb24-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-3"></a><span class="st">    </span><span class="kw">decision_tree</span>() <span class="op">%&gt;%</span></span>
<span id="cb24-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-4"></a><span class="st">    </span><span class="kw">set_engine</span>(<span class="st">&quot;C5.0&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb24-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-5"></a><span class="st">    </span><span class="kw">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span>
<span id="cb24-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-6"></a></span>
<span id="cb24-7"><a href="rmedicine2020-course-tidymodels-virtually.html#cb24-7"></a>tree_mod</span></code></pre></div>
<pre><code>## Decision Tree Model Specification (classification)
## 
## Computational engine: C5.0</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb26-1"></a><span class="kw">summary</span>(tree_mod)</span></code></pre></div>
<pre><code>##          Length Class    Mode     
## args     3      -none-   list     
## eng_args 0      quosures list     
## mode     1      -none-   character
## method   0      -none-   NULL     
## engine   1      -none-   character</code></pre>
<p>Fitting a model…</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb28-1"></a>lr_mod <span class="op">%&gt;%</span></span>
<span id="cb28-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb28-2"></a><span class="st">    </span><span class="kw">fit</span>(Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> alz) <span class="op">%&gt;%</span></span>
<span id="cb28-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb28-3"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    8.97      1.98       4.54 5.61e- 6
## 2 tau           -4.01      0.456     -8.79 1.55e-18
## 3 VEGF           0.934     0.130      7.19 6.38e-13</code></pre>
<p>Predicting data…</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-1"></a><span class="co"># Generating new data</span></span>
<span id="cb30-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-2"></a>alz_new &lt;-</span>
<span id="cb30-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-3"></a><span class="st">    </span><span class="kw">tibble</span>(</span>
<span id="cb30-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-4"></a>        <span class="dt">tau =</span> <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>),</span>
<span id="cb30-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-5"></a>        <span class="dt">VEGF =</span> <span class="kw">rep</span>(<span class="dv">15</span>, <span class="dv">3</span>),</span>
<span id="cb30-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-6"></a>        <span class="dt">Class =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Impaired&quot;</span>)</span>
<span id="cb30-7"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-7"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb30-8"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-8"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Class =</span> <span class="kw">factor</span>(Class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Impaired&quot;</span>, <span class="st">&quot;Control&quot;</span>)))</span>
<span id="cb30-9"><a href="rmedicine2020-course-tidymodels-virtually.html#cb30-9"></a>alz_new</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##     tau  VEGF Class   
##   &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;   
## 1     5    15 Control 
## 2     6    15 Control 
## 3     7    15 Impaired</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb32-1"></a><span class="co"># Predicting old data</span></span>
<span id="cb32-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb32-2"></a>tree_mod <span class="op">%&gt;%</span></span>
<span id="cb32-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb32-3"></a><span class="st">    </span><span class="kw">fit</span>(Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> alz) <span class="op">%&gt;%</span></span>
<span id="cb32-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb32-4"></a><span class="st">    </span><span class="kw">predict</span>(<span class="dt">new_data =</span> alz) <span class="op">%&gt;%</span></span>
<span id="cb32-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb32-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">true_class =</span> alz<span class="op">$</span>Class) <span class="op">%&gt;%</span></span>
<span id="cb32-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb32-6"></a><span class="st">    </span><span class="kw">accuracy</span>(<span class="dt">truth =</span> true_class, <span class="dt">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.856</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb34-1"></a><span class="co"># Creating new data with old predictions</span></span>
<span id="cb34-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb34-2"></a>tree_mod <span class="op">%&gt;%</span></span>
<span id="cb34-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb34-3"></a><span class="st">    </span><span class="kw">fit</span>(Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> alz) <span class="op">%&gt;%</span></span>
<span id="cb34-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb34-4"></a><span class="st">    </span><span class="kw">predict</span>(<span class="dt">new_data =</span> alz_new) <span class="op">%&gt;%</span></span>
<span id="cb34-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb34-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">true_class =</span> alz_new<span class="op">$</span>Class) <span class="op">%&gt;%</span></span>
<span id="cb34-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb34-6"></a><span class="st">    </span><span class="kw">accuracy</span>(<span class="dt">truth =</span> true_class, <span class="dt">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.667</code></pre>
<p>Fitting a model can be done in pipeline fashion, which can then be used to predict outcomes. <strong>Axiom</strong>: best way to measure model performance at predicting new data is to <em>predict new data</em></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb36-1"></a><span class="co"># Fitting a model</span></span>
<span id="cb36-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb36-2"></a><span class="kw">fit</span>(tree_mod, Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> alz)</span></code></pre></div>
<pre><code>## parsnip model object
## 
## Fit time:  6ms 
## 
## Call:
## C5.0.default(x = x, y = y, trials = 1, control = C50::C5.0Control(minCases =
##  2, sample = 0))
## 
## Classification Tree
## Number of samples: 333 
## Number of predictors: 2 
## 
## Tree size: 4 
## 
## Non-standard options: attempt to group attributes</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-1"></a><span class="co"># Step by step</span></span>
<span id="cb38-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-2"></a>tree_fit &lt;-</span>
<span id="cb38-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-3"></a><span class="st">    </span>tree_mod <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># parsnip model</span></span>
<span id="cb38-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-4"></a><span class="st">    </span><span class="kw">fit</span>(</span>
<span id="cb38-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-5"></a>        Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF,  <span class="co"># Formula</span></span>
<span id="cb38-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-6"></a>        <span class="dt">data =</span> alz <span class="co"># dataframe</span></span>
<span id="cb38-7"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-7"></a>    )</span>
<span id="cb38-8"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-8"></a></span>
<span id="cb38-9"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-9"></a><span class="co"># Predictions.</span></span>
<span id="cb38-10"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-10"></a>tree_fit <span class="op">%&gt;%</span></span>
<span id="cb38-11"><a href="rmedicine2020-course-tidymodels-virtually.html#cb38-11"></a><span class="st">    </span><span class="kw">predict</span>(<span class="dt">new_data =</span> alz_new)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   .pred_class
##   &lt;fct&gt;      
## 1 Control    
## 2 Impaired   
## 3 Impaired</code></pre>
<p>To test out data, splitting and sampling the data is needed. <code>rsample</code> package allows for this.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb40-1"></a><span class="co"># Split data into single testing and training set</span></span>
<span id="cb40-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb40-2"></a>alz_split &lt;-<span class="st"> </span><span class="kw">initial_split</span>(alz, <span class="dt">strata =</span> Class, <span class="dt">prop =</span> <span class="fl">0.9</span>)</span>
<span id="cb40-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb40-3"></a></span>
<span id="cb40-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb40-4"></a><span class="co"># Training and testing the data splits can be extracted ussing rsample</span></span>
<span id="cb40-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb40-5"></a>alz_train &lt;-<span class="st"> </span><span class="kw">training</span>(alz_split)</span>
<span id="cb40-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb40-6"></a>alz_test &lt;-<span class="st"> </span><span class="kw">testing</span>(alz_split)</span></code></pre></div>
<p>As an example, using the <strong>alz</strong> data, can use test and train datasets to fit a classification tree model. Predict the test data and save the true classification ability by measuring accuracy.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-1"></a><span class="co"># Train the data</span></span>
<span id="cb41-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-2"></a>tree_fit &lt;-</span>
<span id="cb41-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-3"></a><span class="st">    </span>tree_mod <span class="op">%&gt;%</span></span>
<span id="cb41-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-4"></a><span class="st">    </span><span class="kw">fit</span>(</span>
<span id="cb41-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-5"></a>        Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF,</span>
<span id="cb41-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-6"></a>        <span class="dt">data =</span> alz_train</span>
<span id="cb41-7"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-7"></a>    )</span>
<span id="cb41-8"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-8"></a></span>
<span id="cb41-9"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-9"></a><span class="co"># Test by predicting</span></span>
<span id="cb41-10"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-10"></a>tree_fit <span class="op">%&gt;%</span></span>
<span id="cb41-11"><a href="rmedicine2020-course-tidymodels-virtually.html#cb41-11"></a><span class="st">    </span><span class="kw">predict</span>(<span class="dt">new_data =</span> alz_test)</span></code></pre></div>
<pre><code>## # A tibble: 33 x 1
##    .pred_class
##    &lt;fct&gt;      
##  1 Control    
##  2 Control    
##  3 Control    
##  4 Control    
##  5 Control    
##  6 Impaired   
##  7 Control    
##  8 Impaired   
##  9 Impaired   
## 10 Impaired   
## # … with 23 more rows</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb43-1"></a>tree_mod <span class="op">%&gt;%</span></span>
<span id="cb43-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb43-2"></a><span class="st">    </span><span class="kw">fit</span>(Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> alz) <span class="op">%&gt;%</span></span>
<span id="cb43-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb43-3"></a><span class="st">    </span><span class="kw">predict</span>(<span class="dt">new_data =</span> alz_new) <span class="op">%&gt;%</span></span>
<span id="cb43-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb43-4"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">true_class =</span> alz_new<span class="op">$</span>Class) <span class="op">%&gt;%</span></span>
<span id="cb43-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb43-5"></a><span class="st">    </span><span class="kw">accuracy</span>(<span class="dt">truth =</span> true_class, <span class="dt">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.667</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb45-1"></a><span class="co"># Using decision tree model</span></span>
<span id="cb45-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb45-2"></a>tree_mod <span class="op">%&gt;%</span></span>
<span id="cb45-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb45-3"></a><span class="st">    </span><span class="kw">fit</span>(Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> alz_train) <span class="op">%&gt;%</span></span>
<span id="cb45-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb45-4"></a><span class="st">    </span><span class="kw">predict</span>(<span class="dt">new_data =</span> alz_test) <span class="op">%&gt;%</span></span>
<span id="cb45-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb45-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">true_class =</span> alz_test<span class="op">$</span>Class) <span class="op">%&gt;%</span></span>
<span id="cb45-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb45-6"></a><span class="st">    </span><span class="kw">accuracy</span>(<span class="dt">truth =</span> true_class, <span class="dt">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.879</code></pre>
<p>Measuring the model is through the <code>accuracy()</code> function, which is based on teh two columns of a dataframe…</p>
<ul>
<li>the truth: <span class="math inline">\(y_{i}\)</span></li>
<li>the predicted estimate: <span class="math inline">\(\hat{y}_{i}\)</span></li>
</ul>
<p>This accuracy is dependent on the training/test sets, which is dependent on the overall split (which is random). Resampling is important to fix this problem.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-1"></a><span class="co"># Non-tidy method. Very slow... </span></span>
<span id="cb47-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-2"></a>acc &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> <span class="dv">10</span>, <span class="dt">mode =</span> <span class="st">&quot;double&quot;</span>)</span>
<span id="cb47-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb47-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-4"></a>    new_split &lt;-<span class="st"> </span><span class="kw">initial_split</span>(alz)</span>
<span id="cb47-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-5"></a>    new_train &lt;-<span class="st"> </span><span class="kw">training</span>(new_split)</span>
<span id="cb47-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-6"></a>    new_test &lt;-<span class="st"> </span><span class="kw">testing</span>(new_split)</span>
<span id="cb47-7"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-7"></a>    acc[i] &lt;-</span>
<span id="cb47-8"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-8"></a><span class="st">        </span>lr_mod <span class="op">%&gt;%</span></span>
<span id="cb47-9"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-9"></a><span class="st">        </span><span class="kw">fit</span>(Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF, <span class="dt">data =</span> new_train) <span class="op">%&gt;%</span></span>
<span id="cb47-10"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-10"></a><span class="st">        </span><span class="kw">predict</span>(new_test) <span class="op">%&gt;%</span></span>
<span id="cb47-11"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-11"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">truth =</span> new_test<span class="op">$</span>Class) <span class="op">%&gt;%</span></span>
<span id="cb47-12"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-12"></a><span class="st">        </span><span class="kw">accuracy</span>(truth, .pred_class) <span class="op">%&gt;%</span></span>
<span id="cb47-13"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-13"></a><span class="st">        </span><span class="kw">pull</span>(.estimate)</span>
<span id="cb47-14"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-14"></a>}</span>
<span id="cb47-15"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-15"></a></span>
<span id="cb47-16"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-16"></a><span class="co"># Cross validation works better and is faster</span></span>
<span id="cb47-17"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-17"></a><span class="co"># save the testing data for the end, don&#39;t waste it on training</span></span>
<span id="cb47-18"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-18"></a>alz_folds &lt;-<span class="st"> </span><span class="kw">vfold_cv</span>(alz_train, <span class="dt">v =</span> <span class="dv">10</span>, <span class="dt">strata =</span> Class)</span>
<span id="cb47-19"><a href="rmedicine2020-course-tidymodels-virtually.html#cb47-19"></a>alz_folds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pluck</span>(<span class="st">&quot;splits&quot;</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## &lt;Training/Validation/Total&gt;
## &lt;269/31/300&gt;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-1"></a><span class="co"># Using multiple fits is easier</span></span>
<span id="cb49-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-2"></a>tree_mod <span class="op">%&gt;%</span></span>
<span id="cb49-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-3"></a><span class="st">    </span><span class="kw">fit_resamples</span>(</span>
<span id="cb49-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-4"></a>        Class <span class="op">~</span><span class="st"> </span>tau <span class="op">+</span><span class="st"> </span>VEGF,</span>
<span id="cb49-5"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-5"></a>        <span class="dt">resamples =</span> alz_folds</span>
<span id="cb49-6"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-6"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb49-7"><a href="rmedicine2020-course-tidymodels-virtually.html#cb49-7"></a><span class="st">    </span><span class="kw">collect_metrics</span>(<span class="dt">summarize =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   .metric  .estimator  mean     n std_err
##   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1 accuracy binary     0.811    10  0.0187
## 2 roc_auc  binary     0.784    10  0.0276</code></pre>
</div>
<div id="build-a-workflow" class="section level3">
<h3><span class="header-section-number">12.1.3</span> Build a Workflow</h3>
<p><code>Recipes</code> in R allow for a alternative way to create and preprocess the design matrix needed for modeling.</p>
<ul>
<li>encode categorical predictors</li>
<li>center/scale variables</li>
<li>handle class imbalance</li>
<li>impute missingness</li>
<li>perform dimensionality reduction</li>
<li>etc…</li>
</ul>
<p>General workflow is data is processed with a recipe to create a model. Those are prepared and trained to allow new data to be made on a trained model, which can then allow predictions. These predictions can be compared with the original model, and improved.</p>
<p>Building a recipe is several steps…</p>
<ol style="list-style-type: decimal">
<li>Start the <code>recipe()</code></li>
<li>Define the <strong>variables</strong> involved</li>
<li>Describe the pre-processing <strong>step-by-step</strong></li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="rmedicine2020-course-tidymodels-virtually.html#cb51-1"></a><span class="co"># Recipe with steps</span></span>
<span id="cb51-2"><a href="rmedicine2020-course-tidymodels-virtually.html#cb51-2"></a>rec &lt;-</span>
<span id="cb51-3"><a href="rmedicine2020-course-tidymodels-virtually.html#cb51-3"></a><span class="st">    </span><span class="kw">recipe</span>(Class <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> alz) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># recipe </span></span>
<span id="cb51-4"><a href="rmedicine2020-course-tidymodels-virtually.html#cb51-4"></a><span class="st">    </span><span class="kw">step_other</span>(Genotype, <span class="dt">threshold =</span> <span class="fl">0.03</span>) <span class="co"># Steps</span></span></code></pre></div>

<div id="refs" class="references">
<div>
<p>Fernández, José Ramón, Artemio Mojón, and Ramón C Hermida. 2004. “Comparison of parameters from rhythmometric models with multiple components on hybrid data.” <em>Chronobiology International</em> 21 (3): 469–84. <a href="https://doi.org/10.1081/CBI-120038630">https://doi.org/10.1081/CBI-120038630</a>.</p>
</div>
<div>
<p>Tereshchenko, Larisa G. 2018. “Global Electrical Heterogeneity: Mechanisms and Clinical Significance.” In <em>Computing in Cardiology</em>. Vols. 2018-Septe. IEEE Computer Society. <a href="https://doi.org/10.22489/CinC.2018.165">https://doi.org/10.22489/CinC.2018.165</a>.</p>
</div>
<div>
<p>Waks, Jonathan W., Colleen M. Sitlani, Elsayed Z. Soliman, Muammar Kabir, Elyar Ghafoori, Mary L. Biggs, Charles A. Henrikson, et al. 2016. “Global Electric Heterogeneity Risk Score for Prediction of Sudden Cardiac Death in the General Population: The Atherosclerosis Risk in Communities (ARIC) and Cardiovascular Health (CHS) Studies.” <em>Circulation</em> 133 (23): 2222–34. <a href="https://doi.org/10.1161/CIRCULATIONAHA.116.021306">https://doi.org/10.1161/CIRCULATIONAHA.116.021306</a>.</p>
</div>
</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="tidymodels.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["thoughts.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
